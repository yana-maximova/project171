(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-17cfbe76"],{1148:function(t,e,n){"use strict";var i=n("a691"),a=n("1d80");t.exports="".repeat||function(t){var e=String(a(this)),n="",o=i(t);if(o<0||o==1/0)throw RangeError("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(n+=e);return n}},1435:function(t,e,n){},"3f40":function(t,e,n){},"408a":function(t,e,n){var i=n("c6b6");t.exports=function(t){if("number"!=typeof t&&"Number"!=i(t))throw TypeError("Incorrect invocation");return+t}},"47fb":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"annotation-blocks"},[t.showJson?n("JsonViewer",{attrs:{jsonContent:t.selectedImage},on:{hideJson:function(e){t.showJson=!1}}}):t._e(),n("div",{staticClass:"controls"},[n("input",{ref:"inputImage",staticClass:"hidden",attrs:{type:"file",accept:".jpg, .jpeg, .png",multiple:""},on:{change:t.setImages}}),n("div",{staticClass:"btn-icon",on:{click:function(e){return t.$refs.inputImage.click()}}},[n("font-awesome-icon",{attrs:{icon:"plus"}})],1),n("div",{staticClass:"btn-icon",class:{disabled:!t.modified},on:{click:t.save}},[n("font-awesome-icon",{attrs:{icon:"save"}})],1)]),n("div",{staticClass:"content"},[n("div",{staticClass:"list"},[n("AnnotationsList",{attrs:{items:t.images},on:{viewJson:function(e){t.showJson=!0},selected:function(e){return t.selectImage(e)}}})],1),n("div",{staticClass:"image-editor"},[n("ImageEditor",{attrs:{showBlockControls:!0,imageSize:t.imageSize},model:{value:t.selectedImage,callback:function(e){t.selectedImage=e},expression:"selectedImage"}})],1)])],1)},a=[],o=(n("a15b"),n("b0c0"),n("b680"),n("d3b7"),n("284c")),s=(n("96cf"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"editor"},[n("div",{staticClass:"work-area bordered"},[t.isEmpty?n("span",[t._v("Выберите файл для обработки")]):t._e(),n("section",{directives:[{name:"show",rawName:"v-show",value:!t.isEmpty,expression:"!isEmpty"}],staticClass:"image-area"},[n("div",{staticClass:"controls"},[n("button",{staticClass:"btn-icon control",on:{click:function(e){return t.scale(.1)}}},[n("font-awesome-icon",{attrs:{icon:"search-plus"}})],1),n("button",{staticClass:"btn-icon control",on:{click:function(e){return t.scale(-.1)}}},[n("font-awesome-icon",{attrs:{icon:"search-minus"}})],1),n("button",{staticClass:"btn-icon control",on:{click:t.addBlock}},[n("font-awesome-icon",{attrs:{icon:"th"}})],1)]),n("div",{ref:"content",staticClass:"content",style:{width:t.imageSize.width+"px",height:t.imageSize.height+"px"}},[n("canvas",{ref:"canvas",staticClass:"canvas"}),t.isEmpty?t._e():n("div",t._l(t.value.blocks,(function(e,i){return n("Block",{key:t.value.file+i,attrs:{scaleFactor:t.scaled},on:{remove:function(e){return t.remove(i)}},model:{value:t.value.blocks[i],callback:function(e){t.$set(t.value.blocks,i,e)},expression:"value.blocks[key]"}})})),1)])])])])}),r=[],c=(n("a434"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"block",staticClass:"block",style:{top:t.value.top+"px",left:t.value.left+"px",width:t.value.width+"px",height:t.value.height+"px"},on:{mousedown:function(e){return e.preventDefault(),e.stopPropagation(),t.startMove(e)},mouseup:function(e){return e.preventDefault(),e.stopPropagation(),t.stop(e)},mousemove:function(e){return e.preventDefault(),e.stopPropagation(),t.move(e)}}},[n("div",{staticClass:"remove",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.remove(e)}}},[t._v("x")]),n("div",{staticClass:"resize",on:{mousedown:function(e){return e.preventDefault(),e.stopPropagation(),t.startResize(e)},mouseup:function(e){return e.preventDefault(),e.stopPropagation(),t.stop(e)},mouseleave:function(e){return e.preventDefault(),e.stopPropagation(),t.stop(e)},mousemove:function(e){return e.preventDefault(),e.stopPropagation(),t.resize(e)}}})])}),l=[],u=(n("a9e3"),{name:"Block",props:{value:{type:Object,default:function(){}},scaleFactor:{type:Number,default:1}},data:function(){return{moveble:!1,resizeble:!1,deltaX:0,deltaY:0}},methods:{startMove:function(t){this.moveble=!0,this.deltaX=t.x-this.value.left,this.deltaY=t.y-this.value.top},stop:function(){this.moveble=!1,this.resizeble=!1},move:function(t){if(this.moveble){var e=t.x-this.deltaX,n=t.y-this.deltaY;this.$emit("input",{left:e,top:n,width:this.value.width,height:this.value.height})}},startResize:function(t){this.resizeble=!0,this.deltaX=t.x-this.value.width,this.deltaY=t.y-this.value.height},resize:function(t){if(this.resizeble){var e=t.x-this.deltaX,n=t.y-this.deltaY;this.$emit("input",{left:this.value.left,top:this.value.top,width:e,height:n})}},remove:function(){this.$emit("remove")}}}),f=u,d=(n("cd8a"),n("2877")),h=Object(d["a"])(f,c,l,!1,null,"2235e400",null),m=h.exports,v={name:"ImagesEditor",components:{Block:m},props:{value:{type:Object,default:null},imageSize:{type:Object,required:!0}},data:function(){return{scaled:1}},computed:{isEmpty:function(){return null===this.value}},methods:{addBlock:function(){this.value.blocks.push({top:0,left:0,width:300,height:100})},remove:function(t){this.value.blocks.splice(t,1)},scale:function(t){this.scaled>1&&t<0||this.scaled},load:function(){if(!this.isEmpty){var t=new Image,e=this.$refs.canvas.getContext("2d");t.onload=function(){e.canvas.width=t.width,e.canvas.height=t.height,e.drawImage(t,0,0,e.canvas.width,e.canvas.height)},t.src=this.value.image}}},watch:{value:{deep:!0,handler:function(){this.load()}}},mounted:function(){this.load()}},p=v,g=(n("9489"),Object(d["a"])(p,s,r,!1,null,"3f57d9e9",null)),b=g.exports,w=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("table",t._l(t.items,(function(e,i){return n("tr",{key:i,class:{selected:t.selectedItem===i},on:{click:function(e){return t.selectItem(i)}}},[n("td",{staticClass:"name"},[t._v(t._s(e.file))]),n("td",{staticClass:"controls"},[n("button",{staticClass:"btn-icon control",on:{click:t.viewJSON}},[n("font-awesome-icon",{attrs:{icon:"eye"}})],1),n("button",{staticClass:"btn-icon control trash",on:{click:function(e){return t.removeItem(i)}}},[n("font-awesome-icon",{attrs:{icon:"trash"}})],1)])])})),0)])},I=[],k={props:{items:{type:Array,required:!0}},name:"AnnotationsList",data:function(){return{selectedItem:-1}},methods:{viewJSON:function(){this.$emit("viewJson")},removeItem:function(t){this.$emit("remove",{key:t})},selectItem:function(t){this.selectedItem=t,this.$emit("selected",{key:t})}}},y=k,x=(n("b82b"),Object(d["a"])(y,w,I,!1,null,"a597e644",null)),C=x.exports,N=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"viewer"},[n("div",{staticClass:"overlay",on:{click:function(e){return e.stopPropagation(),t.hide(e)}}}),n("div",{staticClass:"content"},[n("button",{staticClass:"btn-icon close",on:{click:function(e){return e.stopPropagation(),t.hide(e)}}},[n("font-awesome-icon",{attrs:{icon:"times-circle"}})],1),n("pre",[t._v(t._s(t.jsonContent))])])])},E=[],_={name:"JsonViewer",props:{jsonContent:null},data:function(){return{}},methods:{hide:function(){this.$emit("hideJson")}}},A=_,O=(n("a571"),Object(d["a"])(A,N,E,!1,null,"41f70182",null)),$=O.exports,j=n("4a9d"),S={name:"AnnotationBlocks",components:{AnnotationsList:C,ImageEditor:b,JsonViewer:$},data:function(){return{images:[],reader:null,selectedImage:null,showJson:!1,canvas:null,imageSize:{width:400,height:540},modified:!1,loading:!1}},watch:{images:{deep:!0,handler:function(){this.loading?this.loading=!1:this.modified=!0}}},methods:{loadImage:function(t){var e,n,i,a,o,s=this;return regeneratorRuntime.async((function(r){while(1)switch(r.prev=r.next){case 0:return e=this.canvas.getContext("2d"),n=this.grayscaleImage,i=this.imageSize,a=i.width,o=i.height,r.abrupt("return",new Promise((function(i){s.reader.onload=function(t){var s=new Image;s.onload=function(){e.canvas.width=a,e.canvas.height=o,e.drawImage(s,0,0,a,o),i({image:e.canvas.toDataURL("image/jpeg",1),model:n(e.getImageData(0,0,a,o).data)})},s.src=t.target.result},s.reader.readAsDataURL(t)})));case 4:case"end":return r.stop()}}),null,this)},setImages:function(t){var e,n,i,a;return regeneratorRuntime.async((function(s){while(1)switch(s.prev=s.next){case 0:this.reader=new FileReader,e=0,n=Object(o["a"])(t.target.files);case 2:if(!(e<n.length)){s.next=11;break}return i=n[e],s.next=6,regeneratorRuntime.awrap(this.loadImage(i));case 6:a=s.sent,this.images.push({blocks:[],file:i.name,image:a.image,model:a.model});case 8:e++,s.next=2;break;case 11:case"end":return s.stop()}}),null,this)},grayscaleImage:function(t){for(var e=t.length,n=[],i=0;i<e;i+=4){var a=(t[i]+t[i+1]+t[i+2])/3;n.push(a.toFixed(0))}return n.join(",")},selectImage:function(t){this.selectedImage=this.images[t.key]},save:function(){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:this.modified&&(this.$api.apiFunction(this.$api.functionNames.SAVE_ANNOTATIONS_BLOCK,{data:this.images}),this.modified=!1);case 1:case"end":return t.stop()}}),null,this)},startLoad:function(){this.loading=!0,this.$api.apiFunction(this.$api.functionNames.GET_ANNOTATIONS_BLOCK)},load:function(t){this.images=t.data,this.loading=!1}},mounted:function(){this.canvas=document.createElement("canvas"),j["b"].$on("annotations",this.load),this.startLoad()},beforeDestroy:function(){j["b"].$off("annotation",this.load)}},F=S,z=(n("5dc0"),Object(d["a"])(F,i,a,!1,null,"747a0d9e",null));e["default"]=z.exports},"5dc0":function(t,e,n){"use strict";var i=n("1435"),a=n.n(i);a.a},"6e46":function(t,e,n){},7156:function(t,e,n){var i=n("861d"),a=n("d2bb");t.exports=function(t,e,n){var o,s;return a&&"function"==typeof(o=e.constructor)&&o!==n&&i(s=o.prototype)&&s!==n.prototype&&a(t,s),t}},"7adf":function(t,e,n){},9489:function(t,e,n){"use strict";var i=n("7adf"),a=n.n(i);a.a},a15b:function(t,e,n){"use strict";var i=n("23e7"),a=n("44ad"),o=n("fc6a"),s=n("b301"),r=[].join,c=a!=Object,l=s("join",",");i({target:"Array",proto:!0,forced:c||l},{join:function(t){return r.call(o(this),void 0===t?",":t)}})},a434:function(t,e,n){"use strict";var i=n("23e7"),a=n("23cb"),o=n("a691"),s=n("50c4"),r=n("7b0b"),c=n("65f0"),l=n("8418"),u=n("1dde"),f=Math.max,d=Math.min,h=9007199254740991,m="Maximum allowed length exceeded";i({target:"Array",proto:!0,forced:!u("splice")},{splice:function(t,e){var n,i,u,v,p,g,b=r(this),w=s(b.length),I=a(t,w),k=arguments.length;if(0===k?n=i=0:1===k?(n=0,i=w-I):(n=k-2,i=d(f(o(e),0),w-I)),w+n-i>h)throw TypeError(m);for(u=c(b,i),v=0;v<i;v++)p=I+v,p in b&&l(u,v,b[p]);if(u.length=i,n<i){for(v=I;v<w-i;v++)p=v+i,g=v+n,p in b?b[g]=b[p]:delete b[g];for(v=w;v>w-i+n;v--)delete b[v-1]}else if(n>i)for(v=w-i;v>I;v--)p=v+i-1,g=v+n-1,p in b?b[g]=b[p]:delete b[g];for(v=0;v<n;v++)b[v+I]=arguments[v+2];return b.length=w-i+n,u}})},a571:function(t,e,n){"use strict";var i=n("f728"),a=n.n(i);a.a},a9e3:function(t,e,n){"use strict";var i=n("83ab"),a=n("da84"),o=n("94ca"),s=n("6eeb"),r=n("5135"),c=n("c6b6"),l=n("7156"),u=n("c04e"),f=n("d039"),d=n("7c73"),h=n("241c").f,m=n("06cf").f,v=n("9bf2").f,p=n("58a8").trim,g="Number",b=a[g],w=b.prototype,I=c(d(w))==g,k=function(t){var e,n,i,a,o,s,r,c,l=u(t,!1);if("string"==typeof l&&l.length>2)if(l=p(l),e=l.charCodeAt(0),43===e||45===e){if(n=l.charCodeAt(2),88===n||120===n)return NaN}else if(48===e){switch(l.charCodeAt(1)){case 66:case 98:i=2,a=49;break;case 79:case 111:i=8,a=55;break;default:return+l}for(o=l.slice(2),s=o.length,r=0;r<s;r++)if(c=o.charCodeAt(r),c<48||c>a)return NaN;return parseInt(o,i)}return+l};if(o(g,!b(" 0o1")||!b("0b1")||b("+0x1"))){for(var y,x=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof x&&(I?f((function(){w.valueOf.call(n)})):c(n)!=g)?l(new b(k(e)),n,x):k(e)},C=i?h(b):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),N=0;C.length>N;N++)r(b,y=C[N])&&!r(x,y)&&v(x,y,m(b,y));x.prototype=w,w.constructor=x,s(a,g,x)}},b301:function(t,e,n){"use strict";var i=n("d039");t.exports=function(t,e){var n=[][t];return!n||!i((function(){n.call(null,e||function(){throw 1},1)}))}},b680:function(t,e,n){"use strict";var i=n("23e7"),a=n("a691"),o=n("408a"),s=n("1148"),r=n("d039"),c=1..toFixed,l=Math.floor,u=function(t,e,n){return 0===e?n:e%2===1?u(t,e-1,n*t):u(t*t,e/2,n)},f=function(t){var e=0,n=t;while(n>=4096)e+=12,n/=4096;while(n>=2)e+=1,n/=2;return e},d=c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!r((function(){c.call({})}));i({target:"Number",proto:!0,forced:d},{toFixed:function(t){var e,n,i,r,c=o(this),d=a(t),h=[0,0,0,0,0,0],m="",v="0",p=function(t,e){var n=-1,i=e;while(++n<6)i+=t*h[n],h[n]=i%1e7,i=l(i/1e7)},g=function(t){var e=6,n=0;while(--e>=0)n+=h[e],h[e]=l(n/t),n=n%t*1e7},b=function(){var t=6,e="";while(--t>=0)if(""!==e||0===t||0!==h[t]){var n=String(h[t]);e=""===e?n:e+s.call("0",7-n.length)+n}return e};if(d<0||d>20)throw RangeError("Incorrect fraction digits");if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return String(c);if(c<0&&(m="-",c=-c),c>1e-21)if(e=f(c*u(2,69,1))-69,n=e<0?c*u(2,-e,1):c/u(2,e,1),n*=4503599627370496,e=52-e,e>0){p(0,n),i=d;while(i>=7)p(1e7,0),i-=7;p(u(10,i,1),0),i=e-1;while(i>=23)g(1<<23),i-=23;g(1<<i),p(1,1),g(2),v=b()}else p(0,n),p(1<<-e,0),v=b()+s.call("0",d);return d>0?(r=v.length,v=m+(r<=d?"0."+s.call("0",d-r)+v:v.slice(0,r-d)+"."+v.slice(r-d))):v=m+v,v}})},b82b:function(t,e,n){"use strict";var i=n("6e46"),a=n.n(i);a.a},cd8a:function(t,e,n){"use strict";var i=n("3f40"),a=n.n(i);a.a},f728:function(t,e,n){}}]);